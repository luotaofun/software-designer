1
00:00:00,000 --> 00:00:01,540
下面我们看到呢

2
00:00:01,540 --> 00:00:02,700
分组查询

3
00:00:02,700 --> 00:00:04,080
分组查询啊

4
00:00:04,080 --> 00:00:08,090
比我们的普通查询呢，会更复杂一些

5
00:00:08,090 --> 00:00:10,090
那它复杂的地方呢

6
00:00:10,090 --> 00:00:12,270
在于先进行分组

7
00:00:12,270 --> 00:00:14,380
它的分组语句啊

8
00:00:14,380 --> 00:00:18,550
主要呢，体现在按某一个列来分组

9
00:00:18,550 --> 00:00:20,500
分组的过程当中

10
00:00:20,500 --> 00:00:23,640
对于分组之后的条件筛选

11
00:00:23,640 --> 00:00:25,640
用 having 来表示

12
00:00:25,640 --> 00:00:29,630
而不是 where 来进行条件的筛选呢

13
00:00:29,630 --> 00:00:32,470
这里呢，注意一下它的区分

14
00:00:32,470 --> 00:00:35,330
我们在查询语句当中啊

15
00:00:35,330 --> 00:00:38,870
还可能会涉及到一些复杂的极函数

16
00:00:38,870 --> 00:00:42,910
首先呢，我们要知道结果排序可以有升序、降序

17
00:00:42,910 --> 00:00:43,230
诶

18
00:00:43,230 --> 00:00:44,590
order by 某一个字段

19
00:00:44,590 --> 00:00:45,800
前面提到过

20
00:00:45,800 --> 00:00:48,370
那它常见的奇函数啊

21
00:00:48,370 --> 00:00:51,220
跟我们表格处理呢很相似

22
00:00:51,220 --> 00:00:52,220
比如说呢

23
00:00:52,220 --> 00:00:53,840
求和 sum 诶

24
00:00:53,840 --> 00:00:57,120
平均值 avg 、最大值 max 

25
00:00:57,120 --> 00:00:58,720
最小值 mini 

26
00:00:58,720 --> 00:01:01,240
还有呢，统计个数

27
00:01:01,240 --> 00:01:04,150
计数呢，用 count 来进行计数

28
00:01:04,150 --> 00:01:05,860
这里呢，注意一下

29
00:01:05,860 --> 00:01:08,430
技术有两种方式

30
00:01:08,430 --> 00:01:12,750
一种呢，默认它只记录呢，相应的行数

31
00:01:12,750 --> 00:01:18,240
一种呢，是记录不同的 A 属性个数有多少

32
00:01:18,240 --> 00:01:19,540
比如说呢

33
00:01:19,540 --> 00:01:22,950
我们记录学生的选课信息

34
00:01:22,950 --> 00:01:26,430
C 01课程有 S 01

35
00:01:26,430 --> 00:01:30,160
S 02学生都做了选择

36
00:01:30,160 --> 00:01:32,280
那 C 02课程呢

37
00:01:32,280 --> 00:01:35,840
唉，我们也有学员进行了选择

38
00:01:35,840 --> 00:01:38,790
那我们在统计的过程当中啊

39
00:01:38,790 --> 00:01:41,740
比如说针对学生来看

40
00:01:41,740 --> 00:01:46,560
如果对所有记录直接呢，进行 count 统计

41
00:01:46,560 --> 00:01:48,260
不标注 distinct 

42
00:01:48,260 --> 00:01:49,280
特殊的话

43
00:01:49,280 --> 00:01:53,600
那这个地方统计的记录数会有四条

44
00:01:53,600 --> 00:01:58,230
那如果统计的是不同的学号个数的话

45
00:01:58,230 --> 00:02:00,580
我们在这里会统计呢

46
00:02:00,580 --> 00:02:03,320
个数为三条不同的记录

47
00:02:03,320 --> 00:02:07,590
也就是由三名学员参与了选课

48
00:02:07,590 --> 00:02:10,370
那这是呢， distinct 它的一个呢

49
00:02:10,370 --> 00:02:12,760
区别要注意区分

50
00:02:12,760 --> 00:02:15,650
那我们对结果分组的话

51
00:02:15,650 --> 00:02:17,450
我们啊可以 go to by 

52
00:02:17,450 --> 00:02:20,300
也就是呢，分组 by 课程号

53
00:02:20,300 --> 00:02:23,590
那我们呢，可以对所有的课程号

54
00:02:23,590 --> 00:02:26,680
按选了零一课程的记录来分

55
00:02:26,680 --> 00:02:29,440
零二课程的记录来进行分组

56
00:02:29,440 --> 00:02:31,810
也可以按学号来分

57
00:02:31,810 --> 00:02:35,690
那 S 01学生选择的课程记录

58
00:02:35,690 --> 00:02:38,620
然后 S 02学生满足呢

59
00:02:38,620 --> 00:02:41,560
他筛选他所选择的课程记录

60
00:02:41,560 --> 00:02:43,680
这就是呢，分组

61
00:02:44,150 --> 00:02:46,110
分组之后啊

62
00:02:46,110 --> 00:02:49,980
还可以对分组的内容来进行筛选

63
00:02:49,980 --> 00:02:52,800
比如说筛选选课，哎

64
00:02:52,800 --> 00:02:54,460
门数大于三的

65
00:02:54,460 --> 00:02:57,940
我们可以呢，针对学生来分组

66
00:02:57,940 --> 00:03:02,280
在每一个学生当中选择的不同课程号

67
00:03:02,280 --> 00:03:03,920
个数大于三的

68
00:03:03,920 --> 00:03:07,050
那这种呢，就是对结果来筛选的

69
00:03:07,050 --> 00:03:11,020
那这种筛选条件用 heavy 来表示

70
00:03:11,020 --> 00:03:13,130
注意呢，要有所区分

71
00:03:13,130 --> 00:03:15,370
跟 where 呢是不一样的

72
00:03:15,370 --> 00:03:19,120
这就是呢，复杂一些的查询过程

73
00:03:19,120 --> 00:03:21,320
我们对于复杂查询

74
00:03:21,320 --> 00:03:23,900
在软件设计师考察当中呢

75
00:03:23,900 --> 00:03:26,650
出现的频率并不是很高

76
00:03:26,650 --> 00:03:29,700
注意了一些特殊的地方就行了

77
00:03:29,700 --> 00:03:32,300
那我们简单来看一个例子

78
00:03:32,300 --> 00:03:33,220
关于啊

79
00:03:33,220 --> 00:03:35,260
我们复杂的查询

80
00:03:35,260 --> 00:03:38,150
在软件设计师考试当中的体现

81
00:03:38,150 --> 00:03:41,060
主要呢是分组查询的体现

82
00:03:41,060 --> 00:03:43,200
那下面给了我们呢

83
00:03:43,200 --> 00:03:44,600
唉，一个例子

84
00:03:44,600 --> 00:03:47,020
一个例子，在某个企业当中啊

85
00:03:47,020 --> 00:03:49,900
它的项目管理系统的数据当中

86
00:03:49,900 --> 00:03:51,960
有供应商 sup 、 P 

87
00:03:51,960 --> 00:03:54,720
还有呢项目关系 P 、 R 、 O 、 J 

88
00:03:54,720 --> 00:03:56,980
以及呢零件关系 part 

89
00:03:56,980 --> 00:04:00,200
它们之间的压模型如下所示

90
00:04:00,200 --> 00:04:03,630
给了我们相应的关系模式

91
00:04:03,630 --> 00:04:06,640
那其中每个供应商

92
00:04:06,640 --> 00:04:09,980
可以为多个项目来供应多个零件

93
00:04:09,980 --> 00:04:13,320
每个项目可以呢有多个零件，哎

94
00:04:13,320 --> 00:04:15,840
有多个供应商来供应多个零件

95
00:04:15,840 --> 00:04:17,240
那我们会发现

96
00:04:17,240 --> 00:04:21,140
比如说呢，以供应商为核心的话

97
00:04:21,880 --> 00:04:24,360
一个项目有几个供应商啊

98
00:04:24,360 --> 00:04:26,940
它可以有多个供应商来供应吧

99
00:04:26,940 --> 00:04:30,270
所以一个项目有多个供应商

100
00:04:30,270 --> 00:04:34,360
那一个零件可以有多个供应商来供应吗

101
00:04:34,360 --> 00:04:35,160
这个不知道

102
00:04:35,160 --> 00:04:36,900
但是有一端为多

103
00:04:36,900 --> 00:04:39,400
这里呢，多重度就是为多了

104
00:04:39,400 --> 00:04:41,380
那以项目为核心

105
00:04:41,380 --> 00:04:43,200
一个项目可以呢

106
00:04:43,200 --> 00:04:45,600
哎，对应的一个供应

107
00:04:45,600 --> 00:04:47,460
它可以供应几个项目啊

108
00:04:47,460 --> 00:04:49,300
可以供应多个项目吧

109
00:04:49,300 --> 00:04:51,890
每个供应商可以供应多个项目

110
00:04:51,890 --> 00:04:54,730
所以这一段呢，其实也是为多的

111
00:04:54,730 --> 00:04:56,600
以零件为核心

112
00:04:56,600 --> 00:05:00,700
唉，每个项目与之对应的有多个零件

113
00:05:00,700 --> 00:05:03,970
所以呢，这一段多重度也是为多的

114
00:05:03,970 --> 00:05:09,310
那它们之间的联系类型应该是多对、多对多

115
00:05:09,310 --> 00:05:12,030
这涉及到三元联系的判断

116
00:05:12,030 --> 00:05:13,290
这道题当中啊

117
00:05:13,290 --> 00:05:15,050
最难的其实还是呢

118
00:05:15,050 --> 00:05:17,560
联系类型的判断过程了

119
00:05:17,560 --> 00:05:20,760
那给定关系模式当中啊

120
00:05:20,760 --> 00:05:23,100
要求我们查查询

121
00:05:23,100 --> 00:05:27,070
至少供应了三个项目的供应商

122
00:05:27,070 --> 00:05:30,140
哎，那我们在比较的过程当中

123
00:05:30,140 --> 00:05:32,240
它是呢包含三项啊

124
00:05:32,240 --> 00:05:38,230
那要求输出供应商和供应零件数总和

125
00:05:38,230 --> 00:05:43,620
并按相应的供应商号来降序排序的结果

126
00:05:43,620 --> 00:05:47,730
那我们查询的结果包括供应商号

127
00:05:47,730 --> 00:05:50,190
然后呢？还有求和

128
00:05:50,190 --> 00:05:53,130
从哪个表来查

129
00:05:53,170 --> 00:05:56,990
我们查询的是供应商号

130
00:05:56,990 --> 00:06:00,130
以及零件数的数量吧

131
00:06:00,130 --> 00:06:05,340
所以查询的对象应该是 SP 杠 P 

132
00:06:07,880 --> 00:06:10,440
单茶供应商够不够

133
00:06:10,440 --> 00:06:11,240
不够

134
00:06:11,240 --> 00:06:13,800
单查项目够不够呢

135
00:06:13,800 --> 00:06:16,130
不够，单查零件也不够

136
00:06:16,130 --> 00:06:19,940
我们只能啊针对联系的独立关系模式

137
00:06:19,940 --> 00:06:21,400
来进行查询

138
00:06:21,400 --> 00:06:23,500
所以这是呢查询对象

139
00:06:23,500 --> 00:06:26,930
那我们对这个查询对象诶

140
00:06:26,930 --> 00:06:28,490
SP 杠 P 的表

141
00:06:28,490 --> 00:06:31,590
按供应商来进行分组

142
00:06:31,590 --> 00:06:34,480
那比如说呢，01号供应商

143
00:06:34,480 --> 00:06:37,090
它对应的有 P 阶项

144
00:06:37,090 --> 00:06:40,070
零一、 P 阶项目零二、诶

145
00:06:40,070 --> 00:06:45,490
P 1阶项目零三、零一当中供应的零件

146
00:06:46,630 --> 00:06:49,690
P 01、 P 102哎

147
00:06:49,690 --> 00:06:51,870
那这个记录还有 PJ 01啊

148
00:06:51,870 --> 00:06:54,150
所以它可以供应多个项目

149
00:06:54,150 --> 00:06:55,380
要注意区分

150
00:06:55,380 --> 00:06:57,780
那在这个过程当中

151
00:06:57,780 --> 00:07:00,400
我们要满足什么样的条件呢

152
00:07:00,400 --> 00:07:05,270
满足供应的项目大于等于三吧

153
00:07:05,270 --> 00:07:07,730
唉，应该是大于等于三的话

154
00:07:07,730 --> 00:07:13,640
它针对的应该是项目编号的个数来进行统计

155
00:07:14,330 --> 00:07:16,630
那统计的，哎

156
00:07:16,630 --> 00:07:21,610
注意我们的 group buy 一定是跟 having 来组合

157
00:07:21,610 --> 00:07:24,490
并不是无条件筛选

158
00:07:24,490 --> 00:07:25,970
那区别的是

159
00:07:25,970 --> 00:07:29,210
我们到底统计的是不同的项目数

160
00:07:29,210 --> 00:07:32,370
还是呢，统计项目条数就可以了

161
00:07:32,370 --> 00:07:34,790
我们会发现一个项目

162
00:07:34,790 --> 00:07:37,950
可能会供应了多次零件记录

163
00:07:37,950 --> 00:07:40,050
那在这个过程当中

164
00:07:40,050 --> 00:07:45,850
比如说如果01号它供应了 PJ 01，诶

165
00:07:45,850 --> 00:07:47,650
有零件零一、零二

166
00:07:47,650 --> 00:07:51,120
PJ 02供应的零件零二

167
00:07:51,120 --> 00:07:52,940
那这个过程当中

168
00:07:52,940 --> 00:07:56,160
count 数其实是等于三的

169
00:07:56,160 --> 00:07:57,620
满足要求吗

170
00:07:57,620 --> 00:08:01,890
不满足。它所供应的项目数只有两个

171
00:08:01,890 --> 00:08:06,450
所以一定是针对不同项目数的统计

172
00:08:06,450 --> 00:08:08,070
所以啊，这道题呢

173
00:08:08,070 --> 00:08:10,680
选择的应该是 C 选项

174
00:08:10,680 --> 00:08:14,810
那本题它是一个综合的考察

175
00:08:14,810 --> 00:08:18,400
包含了三元联系类型的判断

176
00:08:18,400 --> 00:08:21,060
还有呢，查询对象的判断

177
00:08:21,060 --> 00:08:26,090
以及呢，分组查询它的条件筛选过程

178
00:08:26,090 --> 00:08:28,330
如果说这道题啊

179
00:08:28,330 --> 00:08:30,350
理解起来有困难的话

180
00:08:30,350 --> 00:08:31,770
可以自己呢

181
00:08:31,770 --> 00:08:35,659
去尝同事写一些记录来判断

182
00:08:35,659 --> 00:08:40,700
一定要区别 count 项目号和 count distinct 

183
00:08:40,700 --> 00:08:42,640
这个项目号的区别

184
00:08:42,640 --> 00:08:44,100
不要呢混淆了

185
00:08:44,100 --> 00:08:47,870
一个呢统计的是项目的条目数

186
00:08:47,870 --> 00:08:50,190
一个呢是项目的个数

187
00:08:50,190 --> 00:08:52,860
那这就是呢分组查询

188
00:08:52,860 --> 00:08:55,930
也就是复杂查询的内容

189
00:08:55,930 --> 00:08:58,100
大家呢做这类题目啊

190
00:08:58,100 --> 00:09:00,300
是需要灵活的去思考的
