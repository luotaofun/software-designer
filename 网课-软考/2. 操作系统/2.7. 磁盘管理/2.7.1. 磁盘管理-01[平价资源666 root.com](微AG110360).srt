1
00:00:00,000 --> 00:00:03,050
下面我们看到磁盘管理的部分

2
00:00:03,050 --> 00:00:07,300
磁盘它本身呢，是外存的一部分

3
00:00:07,300 --> 00:00:08,180
那我们呢

4
00:00:08,180 --> 00:00:11,720
有时候也会把它归于设备这一部分啊

5
00:00:11,720 --> 00:00:13,470
所以是磁盘管理呢

6
00:00:13,470 --> 00:00:15,110
本身既是存储管理

7
00:00:15,110 --> 00:00:16,730
也是呢，设备管理

8
00:00:16,730 --> 00:00:19,540
那我们在软件设计师当中呢

9
00:00:19,540 --> 00:00:21,500
主要把它当做一个呢

10
00:00:21,500 --> 00:00:23,470
存储来进行处理了

11
00:00:23,470 --> 00:00:25,480
对于磁盘管理来说呢

12
00:00:25,480 --> 00:00:28,080
在我们软件设计师考试当中啊

13
00:00:28,080 --> 00:00:31,420
考的也算是较为频繁的一个知识内容

14
00:00:31,420 --> 00:00:32,940
那我们在这里呢

15
00:00:32,940 --> 00:00:35,450
主要涉及到三类题型

16
00:00:35,450 --> 00:00:36,020
诶

17
00:00:36,020 --> 00:00:38,880
首先是关于存取时间计算的

18
00:00:38,880 --> 00:00:43,680
有一类呢，是双缓冲区和单缓冲区的区别处理

19
00:00:43,680 --> 00:00:46,900
一类呢，是优化存储的，诶，形式

20
00:00:46,900 --> 00:00:50,240
而优化存储目前在软试考试当中呢

21
00:00:50,240 --> 00:00:52,620
也有近几年没有出现呢

22
00:00:52,620 --> 00:00:54,900
我们会给大家呢做一个介绍

23
00:00:54,900 --> 00:00:57,170
最后呢，是关于磁盘

24
00:00:57,170 --> 00:00:59,370
它的1 B 调度算法

25
00:00:59,370 --> 00:01:01,490
需要大家呢去掌握

26
00:01:01,490 --> 00:01:05,820
首先呢，我们来看一下磁盘它的结构

27
00:01:05,820 --> 00:01:08,290
那磁盘它本身啊

28
00:01:08,290 --> 00:01:10,360
是有多个盘面的啊

29
00:01:10,360 --> 00:01:13,660
我们取其中一个盘面来看的话

30
00:01:13,660 --> 00:01:15,890
那这个盘面的结构

31
00:01:15,890 --> 00:01:19,970
其实跟我们早年在看这一类老上海啊

32
00:01:19,970 --> 00:01:21,130
这种电视剧的时候

33
00:01:21,130 --> 00:01:21,970
看到那种

34
00:01:21,970 --> 00:01:24,780
呃，留声机啊、唱片机啊很像

35
00:01:24,780 --> 00:01:27,010
那它的一个盘面呢

36
00:01:27,010 --> 00:01:31,370
上面可以有很多坑坑洼洼的这种痕迹

37
00:01:31,370 --> 00:01:33,550
其实就是呢，刺刀

38
00:01:33,550 --> 00:01:38,500
那词道它本身这种坑坑洼洼的形式

39
00:01:38,500 --> 00:01:40,500
记录的就是呢，诶

40
00:01:40,500 --> 00:01:43,520
像我们的留声机记录的是声音吧

41
00:01:43,520 --> 00:01:47,390
那在这里呢，可以理解为记录了一些信息

42
00:01:47,390 --> 00:01:50,940
磁头在磁道上旋转的时候啊

43
00:01:50,940 --> 00:01:54,080
读取到的其实就是呢，信息

44
00:01:54,080 --> 00:01:56,810
它的移动就是读取的过程

45
00:01:56,810 --> 00:01:59,640
那针对磁道而言的话

46
00:01:59,640 --> 00:02:04,440
从外向内它的磁道编号会递增

47
00:02:04,640 --> 00:02:08,419
一个盘面上可以有多个同心圆

48
00:02:08,419 --> 00:02:10,370
也就是多个磁刀

49
00:02:10,370 --> 00:02:12,410
对于这些磁道来说呢

50
00:02:12,410 --> 00:02:14,030
一圈有些太大了

51
00:02:14,030 --> 00:02:17,360
那我们呢，又给它细分为了扇区

52
00:02:17,360 --> 00:02:21,370
在此道上每一个角度上的区域呢

53
00:02:21,370 --> 00:02:23,660
可以定义为它的山区

54
00:02:23,660 --> 00:02:26,860
那它的整个磁盘啊

55
00:02:26,860 --> 00:02:29,340
其实是有多个盘面的

56
00:02:29,340 --> 00:02:32,380
每一个盘面上的0号磁道

57
00:02:32,380 --> 00:02:34,280
就可以形成一个呢

58
00:02:34,280 --> 00:02:34,990
主面

59
00:02:34,990 --> 00:02:37,120
这是一个空心的柱体

60
00:02:37,120 --> 00:02:38,890
我们叫做呢柱面

61
00:02:38,890 --> 00:02:43,640
柱面的编号跟磁道其实是一个含义

62
00:02:43,640 --> 00:02:46,560
那我们在存取数据的时候

63
00:02:46,560 --> 00:02:48,500
对于磁盘啊

64
00:02:48,500 --> 00:02:51,550
它的存取是分两个步骤的

65
00:02:51,550 --> 00:02:54,780
第一个步骤是垂直循道

66
00:02:54,780 --> 00:02:59,770
磁头会从相应的位置来进行移动

67
00:02:59,770 --> 00:03:03,710
直到呢，找到我们想要的磁道编号

68
00:03:03,710 --> 00:03:07,670
那这个过程呢，就是垂直寻道

69
00:03:07,670 --> 00:03:09,060
先寻到

70
00:03:09,060 --> 00:03:12,680
然后等待扇区的旋转

71
00:03:12,680 --> 00:03:15,340
叫做呢旋转延迟

72
00:03:15,340 --> 00:03:18,310
对于整个磁盘而言啊

73
00:03:18,310 --> 00:03:20,310
我们可以理解为 A ， A 

74
00:03:20,310 --> 00:03:25,040
它是持续的、匀速的、同向的旋转

75
00:03:25,040 --> 00:03:28,820
那只要呢，这个机器没有停止运行

76
00:03:28,820 --> 00:03:32,160
它就是呢，一直在持续旋转的

77
00:03:32,160 --> 00:03:34,020
所以我们只需要啊

78
00:03:34,020 --> 00:03:37,120
将磁头移到相应的磁道的话

79
00:03:37,120 --> 00:03:41,400
然后接下来的时间就是呢默默地等待

80
00:03:41,400 --> 00:03:43,680
等待我们的扇

81
00:03:43,680 --> 00:03:46,420
旋转到磁头下面的位置

82
00:03:46,420 --> 00:03:49,000
就可以呢进行读取了

83
00:03:49,000 --> 00:03:51,750
也就是说对于磁盘啊

84
00:03:51,750 --> 00:03:54,190
它的存取时间大致呢

85
00:03:54,190 --> 00:03:55,710
可以分两个部分

86
00:03:55,710 --> 00:03:57,990
一个是寻到时间

87
00:03:57,990 --> 00:04:01,850
一个呢是旋转延时的时间

88
00:04:02,370 --> 00:04:05,010
那整个磁盘的话

89
00:04:05,010 --> 00:04:08,170
它可以分成多个盘面

90
00:04:08,170 --> 00:04:11,510
所有的磁头都在呢

91
00:04:11,510 --> 00:04:14,090
同一根主干上面

92
00:04:14,090 --> 00:04:15,830
那也就是说

93
00:04:15,830 --> 00:04:19,740
所有的磁头它是同同时移动的

94
00:04:19,740 --> 00:04:24,400
我们只能一次去寻找同一个磁道

95
00:04:24,400 --> 00:04:26,050
也就是同一个柱面

96
00:04:26,050 --> 00:04:27,590
移动之后

97
00:04:27,590 --> 00:04:30,350
诶，等着磁盘自己旋转

98
00:04:30,350 --> 00:04:35,050
将相应的扇区位置移动到我们的磁头下面

99
00:04:35,050 --> 00:04:37,000
才能进行读取

100
00:04:37,000 --> 00:04:41,140
这就是呢，整个磁盘啊，它的大致结构

101
00:04:41,140 --> 00:04:44,820
那我们首先看到磁盘它的存取

102
00:04:44,820 --> 00:04:48,580
那我们可以呢，将磁盘的数据读取啊

103
00:04:48,580 --> 00:04:53,410
分成寻道时间和旋转延迟时间

104
00:04:53,410 --> 00:04:56,470
以及呢，传输的过程

105
00:04:56,470 --> 00:04:57,620
那我们呢

106
00:04:57,620 --> 00:04:59,380
看下面这个例子

107
00:04:59,380 --> 00:05:03,500
假设磁头从一个磁道到另一个磁道呢

108
00:05:03,500 --> 00:05:05,010
需要10 ms 

109
00:05:05,010 --> 00:05:09,660
那我们文件在磁盘上是可以非连续存放的

110
00:05:09,660 --> 00:05:12,190
逻辑上相邻的数据

111
00:05:12,190 --> 00:05:15,190
注意，我们在读取数据的时候

112
00:05:15,190 --> 00:05:18,450
一般呢，是按逻辑先后来读的

113
00:05:18,450 --> 00:05:21,140
那我们如果逻辑上连续的话

114
00:05:21,140 --> 00:05:24,200
一定是按照连续的逻辑顺序来读

115
00:05:24,200 --> 00:05:28,250
它的平均移动距离是十个磁刀

116
00:05:28,250 --> 00:05:29,300
也就是说

117
00:05:29,300 --> 00:05:34,010
诶，我们读了逻辑零的这个数据之后

118
00:05:34,010 --> 00:05:36,870
到逻辑一的数据中间

119
00:05:36,870 --> 00:05:40,110
跨越了十个词的二的数据

120
00:05:40,110 --> 00:05:42,450
同样能跨越十个磁道

121
00:05:42,450 --> 00:05:44,760
这是一个平均值

122
00:05:44,760 --> 00:05:49,610
每块的旋转延迟以及呢，传输时间

123
00:05:49,610 --> 00:05:52,820
那我们这里呢，有个旋转延迟的时间

124
00:05:52,820 --> 00:05:54,700
还有传输时间吧

125
00:05:54,700 --> 00:05:59,050
好，分别是100 ms 和2 ms 

126
00:05:59,050 --> 00:06:02,070
那如果我们要读100个快

127
00:06:02,070 --> 00:06:03,680
需要多少时间呢

128
00:06:03,680 --> 00:06:05,400
那我们100个块

129
00:06:05,400 --> 00:06:08,650
现在用到的都是平均时间吧

130
00:06:08,650 --> 00:06:12,200
这100个块平均寻道时间的话

131
00:06:12,200 --> 00:06:14,760
每一次都是十个磁道

132
00:06:14,760 --> 00:06:17,370
每个磁道都是10 ms 

133
00:06:17,370 --> 00:06:21,000
那这是每个块的寻道时间

134
00:06:21,000 --> 00:06:25,860
再加上旋转延迟时间结束了吗

135
00:06:25,860 --> 00:06:30,620
没有，还要加上它的数据传输时间

136
00:06:30,620 --> 00:06:33,070
这是一个数据块的

137
00:06:33,070 --> 00:06:37,280
现在有100个数据块乘以100

138
00:06:37,280 --> 00:06:43,660
所以最终的结果应该是20200 ms 

139
00:06:43,660 --> 00:06:48,630
那大致的计算过程可以呢，分成三个部分

140
00:06:48,630 --> 00:06:50,570
它的寻道时间

141
00:06:50,570 --> 00:06:54,090
旋转延迟以及呢，传输时间

142
00:06:54,090 --> 00:06:59,340
这就是一个简单的读取时间的分析过程

143
00:06:59,340 --> 00:07:02,150
那我们在分析的过程当中啊

144
00:07:02,150 --> 00:07:04,930
可能呢，会更复杂一些

145
00:07:04,930 --> 00:07:10,460
比如说传输需要等待受到其他设备的限定

146
00:07:10,460 --> 00:07:14,800
就有了单缓冲区和双缓冲区的题型

147
00:07:14,800 --> 00:07:18,240
我们在后面呢，会展开来讲

148
00:07:18,520 --> 00:07:22,840
那我们呢，在磁盘它的读取过程当中

149
00:07:22,840 --> 00:07:25,300
发现会有三个部分时间吧

150
00:07:25,300 --> 00:07:27,520
首先是寻道时间

151
00:07:27,520 --> 00:07:29,420
其次是旋转延时

152
00:07:29,420 --> 00:07:31,420
第三是传输时间

153
00:07:31,420 --> 00:07:33,370
那么我们会发现啊

154
00:07:33,370 --> 00:07:35,150
旋转延迟时间

155
00:07:35,150 --> 00:07:36,650
这个旋转的过

156
00:07:36,650 --> 00:07:40,530
它是 A 固定的、匀速的、同一方向的

157
00:07:40,530 --> 00:07:42,890
没有任何技巧性可言

158
00:07:42,890 --> 00:07:47,000
传输时间呢，由硬件等方式来决定吧

159
00:07:47,000 --> 00:07:48,360
那我们在这里呢

160
00:07:48,360 --> 00:07:51,460
对于磁盘当中还有一个移臂的过程

161
00:07:51,460 --> 00:07:55,100
是可以设定一定的1 B 调度算法的

162
00:07:55,100 --> 00:07:57,340
对于移臂调度算法呀

163
00:07:57,340 --> 00:07:59,720
大致呢可以分以下几种

164
00:07:59,720 --> 00:08:02,000
第一种方式呢，比较好理解

165
00:08:02,000 --> 00:08:04,690
先来先服务谁先申

166
00:08:04,690 --> 00:08:07,610
我们呢，就优先响应谁

167
00:08:07,610 --> 00:08:08,790
第二种呢

168
00:08:08,790 --> 00:08:11,100
最短寻道时间优先

169
00:08:11,100 --> 00:08:12,790
那我们会考虑呀

170
00:08:12,790 --> 00:08:15,150
在当前情况下诶

171
00:08:15,150 --> 00:08:16,570
剩下的这些申请

172
00:08:16,570 --> 00:08:19,090
谁离我的词套数最近

173
00:08:19,090 --> 00:08:21,290
我就呢先响应谁

174
00:08:21,290 --> 00:08:23,100
响应之后再在呢

175
00:08:23,100 --> 00:08:25,220
新的当前位置下考虑

176
00:08:25,220 --> 00:08:28,000
离我最近的是谁，我就响应

177
00:08:28,000 --> 00:08:31,010
这就是呢，最短寻道时间优先

178
00:08:31,010 --> 00:08:33,440
第三种，扫描算法

179
00:08:33,440 --> 00:08:36,740
它也叫做呢电梯算法

180
00:08:39,659 --> 00:08:43,429
它是一个双向扫描的过程

181
00:08:43,429 --> 00:08:44,770
大家想一想啊

182
00:08:44,770 --> 00:08:46,430
对于电梯而言

183
00:08:46,430 --> 00:08:49,720
是既可以上楼也可以下楼的吧

184
00:08:49,720 --> 00:08:52,190
那我们在响应的过程当中

185
00:08:52,190 --> 00:08:55,970
你在某一层按向上的时候

186
00:08:55,970 --> 00:09:00,940
电梯从底层到最高层会依次响应诶

187
00:09:00,940 --> 00:09:02,760
所有向上的申请吧

188
00:09:02,760 --> 00:09:06,460
那这个过程就是一次扫描过程

189
00:09:06,460 --> 00:09:08,050
那还有呢

190
00:09:08,050 --> 00:09:10,930
唉，如果我们按向下的话

191
00:09:10,930 --> 00:09:15,480
那从最高层向最底层会依次响应

192
00:09:15,480 --> 00:09:17,860
相应的向下申请吧

193
00:09:17,860 --> 00:09:20,300
针对磁盘而言的话

194
00:09:20,300 --> 00:09:23,600
它会呢，扫描从最外到最内

195
00:09:23,600 --> 00:09:25,330
从最内到最外

196
00:09:25,330 --> 00:09:31,140
双向扫描中间所遇到的所有申请来进行处理

197
00:09:31,140 --> 00:09:33,090
这就是呢，扫描算法

198
00:09:33,090 --> 00:09:35,370
也叫做电梯算法

199
00:09:35,370 --> 00:09:38,670
最后还有一个呢，循环扫描算法

200
00:09:38,670 --> 00:09:41,220
相对来说，这种算法呀

201
00:09:41,220 --> 00:09:43,680
它是一个单向的过程

202
00:09:43,680 --> 00:09:46,880
它是固定由外向内

203
00:09:46,880 --> 00:09:50,040
或者由内向外的响应申请

204
00:09:50,040 --> 00:09:52,660
一般呢，题目会告诉大家

205
00:09:52,660 --> 00:09:56,580
以什么样的形式来单向扫

206
00:09:56,580 --> 00:09:57,850
电梯算法呢

207
00:09:57,850 --> 00:10:01,130
也会告诉大家当前是由内向外的

208
00:10:01,130 --> 00:10:03,130
还是呢，由外向内的

209
00:10:03,130 --> 00:10:04,150
这就是呢

210
00:10:04,150 --> 00:10:07,620
磁盘移臂调度的几种算法啊

211
00:10:07,620 --> 00:10:08,720
那我们呢

212
00:10:08,720 --> 00:10:10,280
在考试当中啊

213
00:10:10,280 --> 00:10:12,520
近几年出现的一种题型

214
00:10:12,520 --> 00:10:17,960
就是呢，让大家来判断响应的这种呢，申请序列

215
00:10:17,960 --> 00:10:20,510
那对于这种序列而言啊

216
00:10:20,510 --> 00:10:24,380
因为我们的磁盘是固定匀速转动的

217
00:10:24,380 --> 00:10:27,270
那磁头在移动的过程当中

218
00:10:27,270 --> 00:10:30,920
其实是可以理解为抛物线的形式

219
00:10:30,920 --> 00:10:32,650
很难去计算

220
00:10:32,650 --> 00:10:35,330
所以针对这种移臂调度啊

221
00:10:35,330 --> 00:10:39,310
我们只需要考虑它对磁道的响应顺序

222
00:10:39,310 --> 00:10:40,210
就可以了

223
00:10:40,210 --> 00:10:44,280
一个磁道如果多个扇区都有任务的话

224
00:10:44,280 --> 00:10:46,480
那究竟谁先谁后

225
00:10:46,480 --> 00:10:48,800
其实是没有定论的

226
00:10:48,800 --> 00:10:50,360
我们只要知道呢

227
00:10:50,360 --> 00:10:53,560
按词道来划分就可以了

228
00:10:53,560 --> 00:10:56,450
那磁道跟柱面号呢

229
00:10:56,450 --> 00:10:59,030
又是同一个概念

230
00:10:59,100 --> 00:11:02,780
所以啊，大家在做这类试题的时候

231
00:11:02,780 --> 00:11:06,550
只要了解它响应的词的或者柱面顺序

232
00:11:06,550 --> 00:11:08,820
就足以呢去做题了

233
00:11:08,820 --> 00:11:12,220
扇区的顺序不要求大家了解

234
00:11:12,220 --> 00:11:15,120
我们来看一下它的大致响应过程

235
00:11:15,120 --> 00:11:18,550
对于这些任务申请来看的话

236
00:11:18,550 --> 00:11:20,500
先来先服务

237
00:11:20,500 --> 00:11:26,050
会根据相应的申请序号依次来进行响应

238
00:11:26,050 --> 00:11:29,410
比如说从100号磁道开始

239
00:11:29,410 --> 00:11:34,570
那接下来一号序列是55号迟到的任务

240
00:11:34,570 --> 00:11:36,710
那我们呢，就响应55号

241
00:11:36,710 --> 00:11:39,380
此道跨越了45个磁道吧

242
00:11:39,380 --> 00:11:42,000
那下面呢，是58号词的

243
00:11:42,000 --> 00:11:43,850
跨越了三个词道

244
00:11:43,850 --> 00:11:46,230
唉，然后是39号磁道

245
00:11:46,230 --> 00:11:48,500
跨越了19号磁道

246
00:11:48,500 --> 00:11:50,950
接下来呢，是18号磁道

247
00:11:50,950 --> 00:11:52,550
跨越了21

248
00:11:52,550 --> 00:11:55,040
再到90跨越72

249
00:11:55,040 --> 00:11:57,120
160跨越70

250
00:11:57,120 --> 00:11:59,480
150跨越十

251
00:11:59,480 --> 00:12:03,520
然后呢，到38跨越112

252
00:12:03,520 --> 00:12:06,820
最后184跨越146

253
00:12:06,820 --> 00:12:11,510
把这些啊，移动的磁道数可以呢，依次记录下来

254
00:12:11,510 --> 00:12:12,790
我们会发现啊

255
00:12:12,790 --> 00:12:15,920
那这十，这九次任务啊

256
00:12:15,920 --> 00:12:17,420
平均寻到

257
00:12:17,420 --> 00:12:19,760
哎，55.3个磁刀

258
00:12:19,760 --> 00:12:22,670
这个词刀数其实还是蛮大的啊

259
00:12:22,670 --> 00:12:27,570
那如果是根据最短寻道时间优先的话

260
00:12:27,570 --> 00:12:31,740
我们把所有的任务列出来之后会发现呢

261
00:12:31,740 --> 00:12:34,060
离100最近的是90

262
00:12:34,060 --> 00:12:37,320
所以先找90跨越十个磁道

263
00:12:37,320 --> 00:12:39,730
离90最近的是58

264
00:12:39,730 --> 00:12:41,470
跨越的32

265
00:12:41,470 --> 00:12:45,220
离58最近的是55，跨越三

266
00:12:45,220 --> 00:12:47,680
离55最近的是39

267
00:12:47,680 --> 00:12:48,910
跨越16

268
00:12:48,910 --> 00:12:50,630
接下来是38

269
00:12:50,630 --> 00:12:53,470
跨越18跨越20

270
00:12:53,470 --> 00:12:55,110
以此类推

271
00:12:55,110 --> 00:12:58,880
把所有的跨越词道数再记录下来

272
00:12:58,880 --> 00:13:00,300
我们就会发现呢

273
00:13:00,300 --> 00:13:04,750
唉，当前的平均寻道就变成了27.5

274
00:13:04,750 --> 00:13:06,770
压缩了将近一半吧

275
00:13:06,770 --> 00:13:09,330
那这个过程我们就是呢

276
00:13:09,330 --> 00:13:11,530
最短寻道时间优先

277
00:13:11,530 --> 00:13:13,990
站在当前的位置

278
00:13:13,990 --> 00:13:17,620
判断离他最近的是谁

279
00:13:17,620 --> 00:13:18,870
这就是呢

280
00:13:18,870 --> 00:13:22,530
唉，最短寻道时间优先的算法

281
00:13:22,530 --> 00:13:26,340
那如果是唉，我们的电梯算法

282
00:13:26,340 --> 00:13:29,300
它会按照一定的顺序，诶

283
00:13:29,300 --> 00:13:32,310
跨越词的双向扫描

284
00:13:32,310 --> 00:13:35,240
如果是单向扫描算法的话

285
00:13:35,240 --> 00:13:36,900
循环扫描算法的话

286
00:13:36,900 --> 00:13:40,250
会告诉大家它跨越的方式

287
00:13:40,250 --> 00:13:45,460
然后呢，直接回到起始的最高或者最低位置

288
00:13:45,460 --> 00:13:47,630
再次的进行扫描

289
00:13:47,630 --> 00:13:51,570
这就是呢唉我们一并调度的过程
